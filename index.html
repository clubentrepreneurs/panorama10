<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>One Page Babylon + Menu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <link href="https://fonts.cdnfonts.com/css/apex-new" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.10.2/lottie.min.js"></script>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      overflow: hidden;
      background: none;
    }

    /* === Pages === */
    .page {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.7s ease-in-out;
      z-index: 0;
    }
    .page.active {
      opacity: 1;
      pointer-events: auto;
      z-index: 1; /* Toujours au-dessus quand actif */
    }

    /* === Canvas Babylon === */
    #renderCanvas {
      width: 100%;
      height: 100%;
      display: block;
      background-color: transparent !important;
    }
    #renderCanvas.hidden { visibility: hidden; }

    /* === Lottie Intro === */
    #lottie-container {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: white;
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: opacity 1s ease-in-out;
    }
    #lottie-container.fade-out {
      opacity: 0;
      pointer-events: none;
    }

    /* === Texte stylisÃ© === */
    #customText {
      position: absolute;
      bottom: 5vh; left: 50%;
      transform: translateX(-50%);
      font-family: 'Apex New', sans-serif;
      font-size: clamp(24px, 4vw, 48px);
      font-weight: bold;
      text-align: center;
      color: black;
      cursor: pointer;
      transition: font-size 0.3s ease-in-out, transform 0.3s ease-in-out;
      z-index: 2000;
    }
    #customText.zoomed {
      font-size: clamp(36px, 6vw, 72px);
      transform: translateX(-50%) scale(1.1);
    }

    /* === Boutons === */
    .actionButton {
      position: fixed;
      bottom: 20px;
      width: 50px; height: 50px;
      border-radius: 50%;
      background-color: #E5005B;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }
    #scrollButton { right: 20px; }
    #linkButton { right: 80px; font-size: 16px; }

    /* === Page 2 style === */
    #page2 {
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: 'Apex New', sans-serif;
      background: #f5f5f5;
    }
    #page2 h1 {
      font-size: 3em;
      color: #E5005B;
    }
  </style>
</head>
<body>
  <!-- Intro Lottie -->
  <div id="lottie-container"></div>

  <!-- === Page 1 (Babylon + boutons) === -->
  <div id="page1" class="page active">
    <canvas id="renderCanvas" class="hidden"></canvas>
    <div id="customText">Clique-moi</div>
    <button id="scrollButton" class="actionButton">&#x21bb;</button>
    <button id="linkButton" class="actionButton">Go</button>
  </div>

  <!-- === Page 2 (nouveau contenu) === -->
  <div id="page2" class="page">
    <h1>Bienvenue sur la Page 2 ðŸš€</h1>
  </div>

  <!-- Scripts Babylon + Lottie -->
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
  <script>
    const canvas = document.getElementById("renderCanvas");
    const engine = new BABYLON.Engine(canvas, true, { alpha: true });
    const scene = new BABYLON.Scene(engine);
    scene.clearColor = new BABYLON.Color4(0,0,0,0);

    const camera = new BABYLON.ArcRotateCamera("cam", Math.PI/2, Math.PI/2.5, 300, new BABYLON.Vector3(0,0,0), scene);
    camera.attachControl(canvas, true);
    camera.inputs.clear();
    new BABYLON.HemisphericLight("light", new BABYLON.Vector3(0,1,0), scene);

    // === Gestion Lottie intro ===
    document.addEventListener("DOMContentLoaded", () => {
      const lottieContainer = document.getElementById('lottie-container');
      const anim = lottie.loadAnimation({
        container: lottieContainer,
        renderer: 'svg',
        loop: false,
        autoplay: true,
        path: 'intro.json' // ton fichier d'anim JSON
      });

      anim.addEventListener('complete', () => {
        lottieContainer.classList.add('fade-out');
        setTimeout(() => { lottieContainer.style.display = 'none'; }, 1000);
        canvas.classList.remove('hidden');
      });

      // Bouton scroll (fait tourner la camÃ©ra)
      document.getElementById('scrollButton').addEventListener('click', () => {
        const rot = 30 * (Math.PI/180);
        BABYLON.Animation.CreateAndStartAnimation("scrollCam", camera, "alpha", 60, 60, camera.alpha, camera.alpha + rot, BABYLON.Animation.ANIMATIONLOOPMODE_CONSTANT);
      });

      // Bouton Go (transition vers page2)
      document.getElementById('linkButton').addEventListener('click', () => {
        showPage("page2");
      });

      // Texte zoom
      document.getElementById("customText").addEventListener("click", e => {
        e.target.classList.toggle("zoomed");
      });
    });

    // === Gestion des pages ===
    function showPage(id) {
      document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    }

    // === Render Babylon ===
    engine.runRenderLoop(() => scene.render());
    window.addEventListener("resize", () => engine.resize());
  </script>
</body>
</html>
